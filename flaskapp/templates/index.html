<!DOCTYPE html>
<head>
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script src="/static/interaction.js"></script>
</head>
<style>
div.scroll_div {
  background-color: lightblue;
  width: 600px;
  height: 110px;
  overflow: scroll;


}

div.gen_info {
background-color: pink;

}
</style>
<body>


<!--To display current json string, add {{data}} in the div  -->
<!-- currently used network. This is just here for debugging purposes-->

<div>
	<h1> See Global params for testing </h1>
	<h2>Graph Json Data is (hidden in final)</h2>
		<div id="data_test" class="scroll_div">
		{{data}}
		</div>
	<h2>Random Walk is (hidden in final)</h2>
		<div id="randomwalk_test" class="scroll_div">
			{{random_walk}}
		</div>
	<h2>Key is (Part of form in final)</h2>
		<div id="key_test">
			{{key}}
		</div>
	<h2>Offset is </h2>
		<div id="offset_test">
			{{offsets}}
		</div>
	<h2>Grouping is </h2>
		<div id="grouping_test">
			{{grouping}}
		</div>
</div>	
<br>	
<br>
<br>
<h1> Start Real Application Section </h1>

<h2> Data Features </h2>
<div class="gen_info">
	<form id="changeparams"  method = "post" 
			enctype="multipart/form-data">
  	  <fieldset> 
            <label for="key">


                Enter Key of piece being processed. (for pieces in a minor 
                key, enter the relative major):
            </label>
            <input type="text" id="key" name="key">
            (e.g. <i>A</i>  )          
            <br>
            <br>

            <label for="grouping">
                Enter New Measure Offsets for Forced Grouping graph 
                as measure numbers separated by spaces:
            </label>
            <input type="text" id="grouping" name="grouping" >
            ( e.g. <i>1 10 20 </i>) 
            <br>
            <br>
            <label for="offsets">
                Enter New New Note Offsets for Roman Numeral Forced 
                Grouping Graph as note offsets separated by spaced:
            </label>
            <input type="text" id="offsets" name="offsets" >
            (e.g. <i>1  35 50 90</i>)
           <br>
          
      </fieldset>

      <fieldset>
 	    	 <button id = "update-params-btn" type="button">Submit</button>
      </fieldset>
	</form>
</div>


<h2> Upload New Piece </h2>
<h3> Accepts files with the extension
    <i>.xml</i>, <i>.mxl</i>, <i>.mid</i> and <i>.musicxml</i>
</h3>

<div class="gen_info">

<!-- Code adapted from 
https://stackoverflow.com/questions/18334717/how-to-upload-a-file-using-an-ajax-call-in-flask
 
--!>
    <form id="upload-file" method="post" enctype="multipart/form-data">
        <fieldset>
            <label for="file">Select a file</label>
            <input name="file" type="file">
        </fieldset>
        <fieldset>
            <button id="upload-file-btn" type="submit">Upload</button>
        </fieldset>
    </form>
</div>
<br>
<br>
<h2>
Click the below button to change to a different encoding scheme
</h2>

<div class="gen_info">
    <fieldset>
        <button id="grouped">
            Display Forced Grouping Graph Encoding
        </button>		
        <button id="basic">
            Display Basic Graph Encoding
        </button>
        <button id="RN">
            Diplay Roman Numeral Graph Encoding 
        </button>
        <button id="grouped_RN">
            Display Grouped Roman Numeral Graph Encoding
        </button>
    </fieldset>
</div>

<h2>
Click the below button to change visualized communities
</h2>

<div class="gen_info">
    <fieldset>
	    <button id="infomap_vis">Change to Infomap</button>		
	    <button id="lpm_vis">Change to LPM</button>
    </fieldset>
</div>


<script>
	//These variables are instantiated in Flask and can be 
	//changed through Observable or directly through html

	
	var data = {{data|tojson}}//corresponds Observable cell
	var random_walk = {{random_walk|tojson}}//corresponds to Observable
	var key = {{key|tojson}}
	var grouping = {{grouping|tojson}}
	var offsets = {{offsets|tojson}}
	//any information coming in needs to be converted to json 
	//(to my knowlege) 
    console.log("In definiing area")
    console.log(random_walk)
</script>

<!-- This script instantiates our Observable script and -->
<!--controls how information is passed in and out of -->
<!-- Observable-->
<script type="module">

// Load the Observable runtime and inspector.
import {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@4/dist/runtime.js";

// Your notebook, compiled as an ES module.

import notebook from "https://api.observablehq.com/@kpet123/music-composition-graph.js?v=3"
// Load the notebook, observing its cells with a default Inspector
// that simply renders the value of each cell into the provided DOM node.
const main = new Runtime().module(notebook, Inspector.into(document.body));

//Match the "data" variable defined in Observable to the data variable
//passed into index.html through Flask
console.log("Testing in Observable- key is :")
console.log(key)
console.log(data)
main.redefine("random_walk", random_walk);

main.redefine("data", data);
</script>





</body>

</html>
